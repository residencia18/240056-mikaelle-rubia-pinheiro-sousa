import{a as H}from"./chunk-R3LL2YX6.js";import{b as y}from"./chunk-SXK2Z643.js";import{a as be,b as ye,d as Ee,e as Ce,f as xe,g as De,h as Te,i as Ie,j as we,k as Fe,l as He,m as Me,o as Oe}from"./chunk-EBXKZ3ZL.js";import{a as ue,b as he}from"./chunk-H3KFRSHM.js";import{b as ge,c as Pe,d as Se,e as M,f as _e}from"./chunk-UT2CUAHE.js";import{$a as J,A as S,Aa as V,D as $,Da as q,E as U,Ea as G,Eb as T,Fa as W,Hb as X,Ia as K,J as N,Jb as Y,Kb as C,Mb as ee,Nb as te,Pb as ie,Qb as oe,R as d,Rb as se,S as l,Sb as re,Tb as ne,Ub as ae,Vb as me,Xb as pe,ac as I,b as x,ca as D,ea as c,ec as w,fb as z,ib as Z,ic as de,j as B,ja as r,ka as p,kb as Q,la as u,lc as le,mc as ce,pa as b,qa as h,r as g,ra as f,tc as fe,u as j,uc as F,vc as ve,w as _,x as L,z as P,za as E}from"./chunk-YJVQKGLP.js";import{a as R,b as k}from"./chunk-CQCHLVVT.js";var A=(()=>{let i=class i{constructor(e,t){this.http=e,this.cookieService=t,this.API_URL=me.fireDatabase,this.JWT_TOKEN=this.cookieService.get("USER_INFO")}getAllPeso(e){let t=this.cookieService.get("USER_INFO");return this.http.get(this.API_URL+"pesos.json",{headers:{Authorization:`Bearer ${t}`}}).pipe(B(o=>{let m=[];for(let n in o)o.hasOwnProperty(n)&&o[n].id_suino===e&&m.push(k(R({},o[n]),{id:n}));return m}))}deletePeso(e){return this.http.delete(this.API_URL+`pesos/${e}.json`)}addPeso(e){return this.http.post(this.API_URL+"pesos.json",e)}editPeso(e,t){return this.http.put(this.API_URL+`pesos/${t}.json`,e)}};i.\u0275fac=function(t){return new(t||i)(N(Z),N(pe))},i.\u0275prov=$({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();function Ue(s,i){if(s&1){let a=b();r(0,"div")(1,"form",1),h("ngSubmit",function(){P(a);let t=f();return S(t.handleSubmitAddPeso())}),r(2,"div",2),u(3,"input",3)(4,"input",4),r(5,"div",5),u(6,"p-button",6),p()()()()}if(s&2){let a=f();d(),c("formGroup",a.addPesoForm),d(5),c("disabled",!a.addPesoForm.valid)}}function qe(s,i){if(s&1){let a=b();r(0,"div")(1,"form",1),h("ngSubmit",function(){P(a);let t=f();return S(t.handleSubmitEditPeso())}),r(2,"div",2),u(3,"input",3)(4,"input",4),r(5,"div",5),u(6,"p-button",6),p()()()()}if(s&2){let a=f();d(),c("formGroup",a.editPesoForm),d(5),c("disabled",!a.editPesoForm.valid)}}var Ne=(()=>{let i=class i{constructor(e,t,o,m,n,v){this.historicoService=e,this.messageService=t,this.formBuilder=o,this.router=m,this.ref=n,this.suinosDtService=v,this.destroy$=new x,this.pesoDatas=[],this.pesoListaDatas=[],this.addPesoForm=this.formBuilder.group({dataPesagem:["",{validators:[C.required],updateOn:"blur"}],pesoKg:["",{validators:[C.required],updateOn:"blur"}]}),this.editPesoForm=this.formBuilder.group({dataPesagem:["",{validators:[C.required],updateOn:"blur"}],pesoKg:["",{validators:[C.required],updateOn:"blur"}]}),this.addPesoEvent=y.ADD_PESO_EVENT,this.editPesoEvent=y.EDIT_PESO_EVENT}ngOnInit(){this.PesoSuinoAction=this.ref.data,this.pesoAction=this.ref.data?.event?.peso,this.PesoSuinoAction?.event?.action==this.editPesoEvent&&this.getPesoSelectedDatas(this.ref.data?.event?.peso),this.getAllPesos()}getAllPesos(){this.historicoService.getAllPeso(this.suinosDtService.id_suino).pipe(g(this.destroy$)).subscribe({next:e=>{e.length>0&&(this.pesoDatas=e)},error:e=>{console.log(e),this.router.navigate(["/dashboard"]),this.messageService.add({severity:"error",summary:"Erro",detail:"Erro ao buscar animais",life:2500})}})}handleSubmitAddPeso(){if(this.addPesoForm?.value&&this.addPesoForm?.valid){let{dataPesagem:e,pesoKg:t}=this.addPesoForm.value;if(this.pesoDatas.some(m=>m.dataPesagem==e))this.messageService.add({severity:"error",summary:"Erro",detail:"O Suino j\xE1 tem pesagem para esse data",life:3e3});else{let n={dataPesagem:e||"",pesoKg:Number(this.addPesoForm.value?.pesoKg),id_suino:this.suinosDtService.id_suino};this.historicoService.addPeso(n).pipe().subscribe({next:v=>{v&&(this.messageService.add({severity:"success",summary:"Sucesso",detail:"Peso adicionado com sucesso!",life:2500}),this.pesoDatas=[])},error:v=>{console.log(v),this.messageService.add({severity:"error",summary:"Erro",detail:"Erro ao adicionar Peso",life:2e3})}})}}this.addPesoForm.reset()}handleSubmitEditPeso(){if(this.editPesoForm?.valid)if(this.pesoDatas.some(t=>t.dataPesagem==this.editPesoForm.value.dataPesagem&&t.pesoKg==Number(this.editPesoForm.value.pesoKg)))this.messageService.add({severity:"error",summary:"Erro",detail:"O Suino j\xE1 tem pesagem para esse data.",life:3e3});else{let t={dataPesagem:this.editPesoForm.value.dataPesagem??"",pesoKg:Number(this.editPesoForm.value.pesoKg),id_suino:this.ref.data?.event?.peso?.id_suino};this.historicoService.editPeso(t,this.ref.data?.event?.peso?.id).pipe(g(this.destroy$)).subscribe({next:()=>{this.messageService.add({severity:"sucess",summary:"Sucesso",detail:"Peso editado com sucesso",life:2500}),this.editPesoForm.reset(),this.getAllPesos()},error:o=>{console.log(o),this.router.navigate(["/suino"]),this.messageService.add({severity:"error",summary:"Erro",detail:"Erro ao buscar peso",life:2500})}})}}getPesoSelectedDatas(e){e&&this.editPesoForm.setValue({dataPesagem:e.dataPesagem,pesoKg:String(e.pesoKg)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};i.\u0275fac=function(t){return new(t||i)(l(A),l(w),l(re),l(T),l(Pe),l(H))},i.\u0275cmp=_({type:i,selectors:[["app-historicopeso-form"]],decls:2,vars:2,consts:[[4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"card","flex","flex-column","md:flex-column","gap-3"],["pInputText","","placeholder","Peso do animal","formControlName","pesoKg"],["pInputText","","type","date","placeholder","Data da pesagem","formControlName","dataPesagem"],[1,"flex","flex-row","justify-content-center","align-content-center","align-items-center","m-1"],["type","submit","label","Concluir",3,"disabled"]],template:function(t,o){t&1&&D(0,Ue,7,2,"div",0)(1,qe,7,2,"div",0),t&2&&(c("ngIf",o.ref.data.event.action===o.addPesoEvent),d(),c("ngIf",o.ref.data.event.action===o.editPesoEvent))},dependencies:[J,ie,Y,ee,te,oe,se,F,ue]});let s=i;return s})();function Ge(s,i){if(s&1){let a=b();r(0,"tr")(1,"th",7)(2,"div",8)(3,"div",8),E(4," Data Pesagem "),p(),r(5,"div",8),u(6,"p-sortIcon",9)(7,"p-columnFilter",10),p()()(),r(8,"th",11)(9,"div",8)(10,"div",8),E(11," Peso Kg "),p(),r(12,"div",8),u(13,"p-sortIcon",12)(14,"p-columnFilter",13),p()()(),r(15,"div",14)(16,"p-button",15),h("onClick",function(){P(a);let t=f();return S(t.handlePesoEvent(t.addPesoEvent))}),p()()()}s&2&&(d(7),c("showMatchModes",!1)("showOperator",!1)("showAddButton",!1),d(7),c("showMatchModes",!1)("showOperator",!1)("showAddButton",!1))}function We(s,i){if(s&1){let a=b();r(0,"tr")(1,"td"),E(2),p(),r(3,"td"),E(4),p(),r(5,"td")(6,"div",16)(7,"button",17),h("click",function(){let o=P(a).$implicit,m=f();return S(m.handlePesoEvent(m.editPesoEvent,o))}),p(),r(8,"button",18),h("click",function(){let o=P(a).$implicit,m=f();return S(m.handleDeletePeso(o.id,o.pesoKg))}),p()()()()}if(s&2){let a=i.$implicit;d(2),V(a.pesoKg),d(2),V(a.dataPesagem)}}var Je=()=>["dataPesagem","pesoKg"],ze=()=>({"min-width":"75rem"}),Ve=(()=>{let i=class i{constructor(){this.Pesos=[],this.historicoEvent=new j,this.deletePesoHistorico=new j,this.addPesoEvent=y.ADD_PESO_EVENT,this.editPesoEvent=y.EDIT_PESO_EVENT}handlePesoEvent(e,t){if(e&&e!==" "){let o=t&&t!==null?{action:e,peso:t}:{action:e};console.log("suinoEventDataPeso",o),this.historicoEvent.emit(o)}}handleDeletePeso(e,t){e!==null&&this.deletePesoHistorico.emit({id:e,pesoKg:t})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=_({type:i,selectors:[["app-historico-peso-table"]],inputs:{Pesos:"Pesos"},outputs:{historicoEvent:"historicoEvent",deletePesoHistorico:"deletePesoHistorico"},decls:7,vars:11,consts:[[1,"grid"],[1,"col-12"],["header","Historico de Peso","styleClass","shadow-3 m-5 text-indigo-800"],["data","id","currentPageReportTemplate","Mostrando {first} de {last} de pesos",3,"value","rows","paginator","responsive","globalFilterFields","tableStyle","selection","rowHover","showCurrentPageReport","selectionChange"],["HistoricoTable",""],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","dataPesagem"],[1,"flex","justify-content-between","align-items-center"],["field","dataPesagem"],["type","text","field","dataPesagem","display","menu","matchMode","contains",3,"showMatchModes","showOperator","showAddButton"],["pSortableColumn","pesoKg"],["field","pesoKg"],["type","text","field","pesoKg","display","menu","matchMode","contains",3,"showMatchModes","showOperator","showAddButton"],[1,"flex","justify-content-center"],["styleClass","p-button-info","icon","pi pi-plus","label","Adicionar","pTooltip","Adicionar produto","tooltipPosition","top",3,"onClick"],[1,"flex","justify-content-center","grap-3","align-content-center","align-items-center"],["pButton","","pRipple","","icon","pi pi-pencil","pTooltip","Editar","tooltipPosition","top",1,"p-button-secondary",3,"click"],["pButton","","pRipple","","icon","pi pi-trash","pTooltip","Remover","tooltipPosition","top",1,"p-button-danger",3,"click"]],template:function(t,o){t&1&&(r(0,"div",0)(1,"div",1)(2,"p-card",2)(3,"p-table",3,4),W("selectionChange",function(n){return G(o.HistoricoSelected,n)||(o.HistoricoSelected=n),n}),D(5,Ge,17,6,"ng-template",5)(6,We,9,2,"ng-template",6),p()()()()),t&2&&(d(3),c("value",o.Pesos)("rows",10)("paginator",!0)("responsive",!0)("globalFilterFields",K(9,Je))("tableStyle",K(10,ze)),q("selection",o.HistoricoSelected),c("rowHover",!0)("showCurrentPageReport",!0))},dependencies:[le,de,fe,F,xe,De,Te,Ie,be]});let s=i;return s})();var Ke=(()=>{let i=class i{constructor(e,t,o,m,n,v){this.messageService=e,this.suinosDtService=t,this.dialogService=o,this.pesoSuinoService=m,this.confirmationService=n,this.router=v,this.destroy$=new x,this.pesoSuinoList=[],this.id="",this.suino=null}ngOnInit(){this.getServiceHistoricoData(this.suinosDtService.id_suino)}getServiceHistoricoData(e){let t=this.suinosDtService.getPesoDatas(e);t.length>0?(this.pesoSuinoList=t,console.log("DADOS DOS PESOS",this.pesoSuinoList)):this.getAPIPesoSuinoDtas()}getAPIPesoSuinoDtas(){this.pesoSuinoService.getAllPeso(this.suinosDtService.id_suino).pipe(g(this.destroy$)).subscribe({next:e=>{e.length>0&&(this.pesoSuinoList=e)},error:e=>{console.log(e),this.router.navigate(["/dashboard"]),this.messageService.add({severity:"error",summary:"Erro",detail:"Erro ao buscar pesos",life:2500})}})}handlepesoEvent(e){e&&(e.suino_id=this.suinosDtService.id_suino,this.ref=this.dialogService.open(Ne,{header:e?.action,width:"70%",contentStyle:{overflow:"auto"},baseZIndex:1e4,maximizable:!0,data:{event:e,peso:this.pesoSuinoList}}),this.ref.onClose.pipe(g(this.destroy$)).subscribe({next:()=>this.getAPIPesoSuinoDtas()}))}handleDeletePeso(e){if(e){this.deletePeso(e.id);let t=e.id;this.confirmationService.confirm({message:"Confirma a exclus\xE3o do peso?",header:"Confirma\xE7\xE3o de exclus\xE3o",icon:"pi pi-exclamation-triangle",acceptLabel:"Sim",rejectLabel:"N\xE3o",accept:()=>this.deletePeso(t)})}}deletePeso(e){e&&this.pesoSuinoService.deletePeso(e).pipe(g(this.destroy$)).subscribe({next:t=>{t&&this.messageService.add({severity:"success",summary:"Sucesso",detail:"Peso removido com sucesso!",life:2500}),this.getAPIPesoSuinoDtas()},error:t=>{console.log(t),this.messageService.add({severity:"error",summary:"Erro",detail:"Erro ao deletar Suino",life:2e3})}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}};i.\u0275fac=function(t){return new(t||i)(l(w),l(H),l(M),l(A),l(I),l(T))},i.\u0275cmp=_({type:i,selectors:[["app-historicopeso-home"]],decls:2,vars:1,consts:[[3,"Pesos","historicoEvent","deletePesoHistorico"]],template:function(t,o){t&1&&(u(0,"app-toolbar-navigation"),r(1,"app-historico-peso-table",0),h("historicoEvent",function(n){return o.handlepesoEvent(n)})("deletePesoHistorico",function(n){return o.handleDeletePeso(n)}),p()),t&2&&(d(),c("Pesos",o.pesoSuinoList))},dependencies:[ge,Ve]});let s=i;return s})();var Re=[{path:"",component:Ke}];var Jt=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=L({type:i}),i.\u0275inj=U({providers:[M,I],imports:[z,ne,ae,X.forChild(Re),_e,Q,ce,ve,we,Fe,He,he,Me,Ce,Se,Ee,Oe,ye]});let s=i;return s})();export{Jt as HistoricoPesoModule};
